#include "<df>/dragonfruit.h"
#include "<ll>/rta3x/a3x.h"
#include "<inc>/kernel.h"

const LSICClaimComplete 0x10

var LSICBase 0

fn DrvLSICFoundNode { node -- }
	"address" a3xDGetProperty LSICBase!

	pointerof LSICInterruptGet InterruptGet!
	pointerof LSICInterruptAck InterruptAck!

	LSICBase@ "  lsic @ 0x%x\n" Printf
end

fn (InterruptGetter) private LSICInterruptGet { -- intn }
	LSICBase@ LSICClaimComplete + @ intn!
end

fn (InterruptAcker) private LSICInterruptAck { intn -- }
	intn@ LSICBase@ LSICClaimComplete + !
end